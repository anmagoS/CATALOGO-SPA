<header class="header d-flex justify-content-between align-items-center px-3 position-relative">
  <!-- LOGO -->
  <div class="logo">
    <a href="INICIO.HTML">
      <img src="logo.jpg" alt="ANMAGO STORE" />
    </a>
  </div>

  <!-- BARRA DE BÚSQUEDA -->
  <div class="buscador-container w-50 position-relative">
    <input type="text" id="buscador" class="form-control" placeholder="Buscar productos, categorías, precios..." autocomplete="off">
    <div id="sugerencias" class="dropdown-menu position-absolute mt-1 w-100"></div>
  </div>

  <!-- BOTÓN HAMBURGUESA -->
  <button class="navbar-toggler border-0 bg-transparent" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuLateral">
    <i class="bi bi-list fs-1 text-white"></i>
  </button>
</header>

<!-- MENÚ LATERAL OFFCANVAS -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="menuLateral">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title">Menú</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column gap-3">
    <a href="INICIO.HTML" class="nav-link">Inicio</a>
    <a href="PROMOS.HTML" class="nav-link">Promociones</a>
    <button class="dropdown-toggle nav-link text-start" id="toggle-categorias">Productos</button>
    <div class="dropdown-menu" id="menu-categorias"></div>
    <a href="https://docs.google.com/forms/..." target="_blank" class="nav-link">Contacto</a>
  </div>
</div>

<!-- SCRIPT DE BÚSQUEDA INTELIGENTE -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const buscador = document.getElementById("buscador");
    const sugerencias = document.getElementById("sugerencias");

    if (!buscador || !sugerencias) return;

    buscador.addEventListener("input", () => {
      const texto = buscador.value.toLowerCase().trim();
      sugerencias.innerHTML = "";

      if (texto.length < 2 || !window.catalogoGlobal) return;

      const coincidencias = window.catalogoGlobal.filter(p =>
        p.producto?.toLowerCase().includes(texto) ||
        p.tipo?.toLowerCase().includes(texto) ||
        p.subtipo?.toLowerCase().includes(texto) ||
        p.categoria?.toLowerCase().includes(texto) ||
        p.material?.toLowerCase().includes(texto) ||
        p.precio?.toString().includes(texto)
      );

      coincidencias.slice(0, 6).forEach(p => {
        const item = document.createElement("a");
        item.className = "dropdown-item d-flex align-items-center gap-2";
        item.href = `producto.html?id=${p.id}`;
        item.innerHTML = `
          <img src="${p.imagen}" alt="${p.producto}" style="width:40px; height:40px; object-fit:cover; border-radius:4px;">
          <span>${p.producto} <small class="text-muted">(${p.tipo} > ${p.subtipo})</small></span>
        `;
        sugerencias.appendChild(item);
      });

      sugerencias.classList.add("show");
    });

    document.addEventListener("click", () => {
      sugerencias.classList.remove("show");
    });
  });
</script>
